#!/usr/bin/env python3

import lark

def main(top):
    with (top / "grammar.lark").open() as f:
        parser = lark.Lark(f.read())
    testfiles = top / "testfiles"
    for tf in testfiles.iterdir():
        print(f"==== {tf}")
        for line in tf.open():
            line = line.strip()
            if not line:
                continue
            print(f"==== {line}")
            parse = parser.parse(line)
            print(parse.pretty())

if __name__ == '__main__':
    import pathlib
    main(pathlib.Path(__file__).parent)
